<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Code Examples · Jayben Bushnell</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <style>
    :root{--bg:#0b0d10; --text:#e6edf3; --muted:#99a2ad; --brand:#5eead4; --brand2:#22d3ee}
    body{background: radial-gradient(1200px 600px at 60% -10%, #0f172a 0%, rgba(15,23,42,0) 60%), var(--bg) !important;
         color:var(--text); font-family:'Outfit',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
    a{color:var(--brand2)}
    .nav-dark{backdrop-filter: blur(8px); background:rgba(11,13,16,.7); border-bottom:1px solid #1f2937}
    .btn-brand{background:linear-gradient(135deg,var(--brand),var(--brand2)); color:#061118; border:none; font-weight:800}
    .card-dark{background:linear-gradient(180deg,#0c1015,#0a0d11); border:1px solid #1f2937; color:var(--text)}
    .section{padding:64px 0}
    pre{position:relative; white-space:pre-wrap}
    .copy{position:absolute; top:8px; right:8px}
    #toTopBtn{position:fixed; bottom:30px; right:30px; display:none; z-index:9999}
  </style>
</head>
<body>
  <nav class="navbar nav-dark sticky-top">
    <div class="container px-3">
      <a class="navbar-brand fw-bold text-light" href="index.html">← Back</a>
      <ul class="navbar-nav flex-row gap-3">
        <li class="nav-item"><a class="nav-link text-light" href="#leetcode-valid-parentheses">LeetCode</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="#diggems-populate-gems">Populate Gems</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="#diggems-gem">Gem</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="#diggems-mineable">Mineable</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="#diggems-iteminstance">ItemInstance</a></li>
      </ul>
    </div>
  </nav>

  <main class="container section">
    <header class="mb-4">
      <h1 class="h3">Code Examples</h1>
      <p class="text-secondary">Your snippets, unchanged (formatting only). Click any “Copy” to put the code on your clipboard.</p>
    </header>

    <section id="leetcode-valid-parentheses" class="mb-5">
      <h2 class="h4 mb-3">Valid Parentheses (LeetCode)</h2>
      <div class="card card-dark mb-3">
        <div class="card-body">
          <pre><button class="btn btn-sm btn-secondary copy" data-target="code1">Copy</button><code id="code1" class="language-cs">public bool IsValid(string s) {
        char[] checkingOpens = {&#x27;(&#x27;, &#x27;{&#x27;, &#x27;[&#x27;};
        char[] checkingCloses = {&#x27;)&#x27;, &#x27;}&#x27;, &#x27;]&#x27;};

        Stack&lt;int&gt; contextWindows = new Stack&lt;int&gt;();

        int c = 0;
        while(c &lt; s.Length)
        {
            for (int i = 0; i &lt; 3; i++) {
                if (checkingOpens[i] == s[c])
                {
                    contextWindows.Push(i);
                    break;
                }
                if (checkingCloses[i] == s[c])
                {
                    if (contextWindows.Count == 0) return false;
                    var latestContext = contextWindows.Peek();
                    if (checkingCloses[latestContext] != s[c])
                    {
                        return false;
                    }
                    contextWindows.Pop();
                    break;
                }
            }
            c++;
        }
        return contextWindows.Count == 0;
    }</code></pre>
        </div>
      </div>
    </section>

    <section id="diggems-populate-gems" class="mb-5">
      <h2 class="h4 mb-3">Diggems: Populate Gems (Spawn on 3D Ore)</h2>
      <div class="card card-dark mb-3">
        <div class="card-body">
          <pre><button class="btn btn-sm btn-secondary copy" data-target="code2">Copy</button><code id="code2" class="language-cs">private async void populateGems()
    {
        await UniTask.WaitUntil(activeInHierarchyFunc);

        possibleGems = new List&lt;LevelBasedDataEntry.EntryValue&gt;();
        if (forcedGemsToSpawn != null)
        {
            possibleGems = forcedGemsToSpawn;
            forcedGemsToSpawn = null;
        }
        else
        {
            var gemDataForLevel = AssetManager.instance.getLevelBaseDatabase().getGemDataForLevel(UserManager.instance.getUser().getLevel());
            possibleGems = gemDataForLevel.entryValues.ToList();
        }
        gemsToAdd = 0;
        foreach (var entry in possibleGems)
        {
            entry.setRandomQuantity();
            gemsToAdd += entry.quantity;
        }
        for (int i = 0; i &lt; gemsToAdd; i++)
        {
            var randomDirection = new Vector3(Random.Range(-1f, 1f), Random.Range(-1f, 1f), Random.Range(-1f, 1f));
            const int distOut = 25;
            var rayOrigin = transform.position + (randomDirection * distOut);

            Ray ray = new(rayOrigin, -randomDirection);
            Vector3 spawnPoint = transform.position;
            if (Physics.Raycast(ray, out RaycastHit hit, distOut * 2, oreRaycastLayer))
            {
                spawnPoint = hit.point;
                createGem(spawnPoint, randomDirection.normalized);
            }
            else
            {
                createGem(spawnPoint, Vector3.up);
            }
        }
    }

    private void createGem(Vector3 spawnPoint, Vector3 targetDirection)
    {
        while (itemsSpawned &gt;= possibleGems[spawningItemIndex].quantity)
        {
            spawningItemIndex++;
            itemsSpawned = 0;
        }
        var spawningItem = possibleGems[spawningItemIndex];
        itemsSpawned++;
        var created = Instantiate(gemPrefab, graphic);
        created.transform.position = spawnPoint;
        var destroyCb = new Action&lt;ItemInstance&gt;(onGemDestroyed);
        var spawningGemAsset = AssetManager.instance.getInventoryAsset(spawningItem.id);
        created.setupWithAsset(spawningGemAsset, destroyCb);
        created.transform.rotation = Quaternion.FromToRotation(Vector3.up, targetDirection);
        gems.Add(created);
    }</code></pre>
        </div>
      </div>
    </section>

    <section id="diggems-gem" class="mb-5">
      <h2 class="h4 mb-3">Diggems: Gem (Mineable)</h2>
      <div class="card card-dark mb-3">
        <div class="card-body">
          <pre><button class="btn btn-sm btn-secondary copy" data-target="code3">Copy</button><code id="code3" class="language-cs">using UnityEngine;
using Random = UnityEngine.Random;

public class Gem : Mineable
{
    [SerializeField] private GameObject popParticle;

    protected override void onSetup()
    {
        base.onSetup();

        var clickable = graphic.gameObject.AddComponent&lt;Clickable&gt;();
        clickable.setClickCallback(OnClick);

        maxHp = (long)Random.Range(inventoryAsset.hpRange.x, inventoryAsset.hpRange.y);
        updateHp(maxHp);
    }

    private void OnClick()
    {
        var equippedPickaxe = UserManager.instance.getUser().getInventory().equippedPickaxe;
        if (equippedPickaxe == null)
        {
            pick(2);//Default of 2 damage for now...
        }
        else
        {
            pick(equippedPickaxe.damage);
        }
    }

    protected override void pick(long pickDamage)
    {
        if (isPoppedOff) return;

        base.pick(pickDamage);
        
        if (hp &lt;= 0)
        {
            popOff();
        }
    }

    public void popOff()
    {
        if (isPoppedOff) return;
        applyGravity();
        HapticFeedback.instance.LightFeedback();
        isPoppedOff = true;
        destroyAfterMaxLife();

        SoundManager.instance.playPopOffSound();
        
        var popParticleEffect = Instantiate(popParticle);
        popParticleEffect.transform.position = transform.position;
        Destroy(popParticleEffect, 3);
    }

    public bool getIsPoppedOff() { return isPoppedOff; }

    private bool isPoppedOff;
}</code></pre>
        </div>
      </div>
    </section>

    <section id="diggems-mineable" class="mb-5">
      <h2 class="h4 mb-3">Diggems: Mineable (Base Class)</h2>
      <div class="card card-dark mb-3">
        <div class="card-body">
          <pre><button class="btn btn-sm btn-secondary copy" data-target="code4">Copy</button><code id="code4" class="language-cs">using UnityEngine;
using Random = UnityEngine.Random;


public class Mineable : ItemInstance
{

    protected override void onSetup()
    {
        base.onSetup();
        updateHp(Random.Range(1, 7));
    }

    protected virtual void pick(long pickDamage)
    {
        if (isDead) return;
        var equippedPickaxe = UserManager.instance.getUser().getInventory().equippedPickaxe;
        var isCrit = false;
        if (equippedPickaxe != null)
        {
            if (Time.time &gt;= equippedPickaxe.cooldownEndTime)
            {
                equippedPickaxe.incrementCooldown();
                pickDamage *= 2;
                isCrit = true;
            }
            equippedPickaxe.decrementDurability(1);
            UserManager.instance.getUser().sendInventoryUpdatedEvent();
        }
        if (pickDamage &lt;= 0) pickDamage = 2;

        HapticFeedback.instance.LightFeedback();

        updateHp(hp-pickDamage);


        CodeAnimations.doShake(graphic, shake);
        var showingDamageText = $&quot;{pickDamage}&quot;;
        if (isCrit) showingDamageText = &quot;&lt;sprite name=\&quot;DamageIcon\&quot;&gt;&quot; + showingDamageText;
        
        UIManager.instance.popTextManager.showDropText(graphic.position, showingDamageText, PopTextManager.PopTextType.Damage, 32);


        if (equippedPickaxe != null)
        {
            playPickSoundPick();
        }
        else
        {
            playPickSoundHand();
        }
    }

    protected virtual void playPickSoundHand()
    {
        var gameSound = SoundManager.instance.getGameSound(&quot;PunchSound&quot;);
        AudioSource.PlayClipAtPoint(gameSound.clip, transform.position, gameSound.volume);
        
    }

    protected virtual void playPickSoundPick()
    {
        AudioSource.PlayClipAtPoint(SoundManager.instance.getRandomPickSound(), transform.position, 0.5f);
    }

    public void setShake(float newVal)
    {
        shake = newVal;
    }

    protected void showDestroyRubble()
    {
        if (rubbleCount &lt;= 0) return;

        // Define the 3D box bounds
        var startPoint = transform.position - new Vector3(gridSize * spacing * 0.5f, gridSize * spacing * 0.5f, gridSize * spacing * 0.5f);
        var boxSize = gridSize * spacing;

        for (int i = 0; i &lt; rubbleCount; i++)
        {
            var created = createRubble();
            if (created == null) return;

            // Calculate a stratified position to approximate even spacing
            float x = i / rubbleCount; // Linear progression for x
            float y = i % (int)Mathf.Sqrt(rubbleCount) / Mathf.Sqrt(rubbleCount); // Rough 2D grid-like spread
            float z = i % (int)(rubbleCount / Mathf.Sqrt(rubbleCount)) / (rubbleCount / Mathf.Sqrt(rubbleCount));

            Vector3 randomOffset = new Vector3(
                Random.Range(-shake, shake),
                Random.Range(-shake, shake),
                Random.Range(-shake, shake)
            );

            // Map to the 3D box space
            Vector3 position = startPoint + new Vector3(
                x * boxSize,
                y * boxSize,
                z * boxSize
            ) + randomOffset;
            created.transform.position = position;
            created.transform.rotation = Quaternion.Euler(Random.Range(-180, 180), Random.Range(-180, 180), Random.Range(-180, 180));
            created.transform.localScale = rubbleSize;
        }
    }

    protected virtual GameObject createRubble()
    {
        return null;
    }

    protected float rubbleCount = 100;
    protected float gridSize = 6;
    private Vector3 rubbleSize = new Vector3(0.5f, 0.5f, 0.5f);
    private float spacing = 0.7f*0.5f;
    private float shake = 0.1f;
}</code></pre>
        </div>
      </div>
    </section>

    <section id="diggems-iteminstance" class="mb-5">
      <h2 class="h4 mb-3">Diggems: ItemInstance (Base)</h2>
      <div class="card card-dark mb-3">
        <div class="card-body">
          <pre><button class="btn btn-sm btn-secondary copy" data-target="code5">Copy</button><code id="code5" class="language-cs">using System;
using Cysharp.Threading.Tasks;
using Unity.VisualScripting;
using UnityEngine;
using static InventoryAssetsDatabase;
using Random = UnityEngine.Random;

public class ItemInstance : MonoBehaviour
{
    public void setupWithAsset(InventoryAsset asset, Action&lt;ItemInstance&gt; newCb = null)
    {
        destroyCb = newCb;
        inventoryAsset = asset;
        var creatingGraphic = asset.prefab;
        if (creatingGraphic == null)
        {
            creatingGraphic = AssetManager.instance.dropBag;
            usingDropBag = true;
        }
        graphic = Instantiate(creatingGraphic, transform).transform;
        graphic.gameObject.layer = gameObject.layer;
        graphic.localPosition = Vector3.zero;
        if (faceCameraAtStart())
        {
            graphic.localRotation = Quaternion.Euler(Random.Range(-180, 180), Random.Range(-180, 180), Random.Range(-180, 180));
        }
        else
        {
            graphic.LookAt(Camera.main.transform);
        }
        meshCollider = graphic.GetComponent&lt;MeshCollider&gt;();
        if (meshCollider == null) meshCollider = graphic.AddComponent&lt;MeshCollider&gt;();
        onSetup();
    }

    protected virtual bool faceCameraAtStart()
    {
        return false;
    }

    protected virtual void onSetup()
    {

    }

    public void applyGravity()
    {
        transform.SetParent(null);
        gameObject.layer = 0;
        graphic.gameObject.layer = 0;
        var rb = gameObject.AddComponent&lt;Rigidbody&gt;();
        rb.isKinematic = false;
    }

    public virtual void die()
    {
        if (isDead) return;
        isDead = true;

        giveOutRewards();

        destroyCb?.Invoke(this);
        Destroy(gameObject);
    }

    private void giveOutRewards()
    {
        if (inventoryAsset == null) return;

        if (inventoryAsset.dropGoldValue &gt; 0)
        {
            UniTask.Void(async () =&gt;
            {
                await UIManager.instance.popTextManager.showFloatUpText(graphic.position, $&quot;{UIManager.instance.getSpriteForGoldAmt(inventoryAsset.dropGoldValue)}{inventoryAsset.dropGoldValue}&quot;, PopTextManager.PopTextType.Gold, 40, UIManager.instance.getHUDController().getGoldValueRectTransform());
                UserManager.instance.giveGold(inventoryAsset.dropGoldValue);
            });
        }

        if (inventoryAsset.dropXpValue &gt; 0)
        {
            UniTask.Void(async () =&gt;
            {
                await UIManager.instance.popTextManager.showFloatUpText(graphic.position, $&quot;&lt;sprite name=\&quot;XP\&quot;&gt;{inventoryAsset.dropXpValue}&quot;, PopTextManager.PopTextType.XP, 25, UIManager.instance.getHUDController().geetXpValueRectTransform());
                UserManager.instance.giveXp(inventoryAsset.dropXpValue*UserManager.xpMultiplier);
            });
        }

        if (!inventoryAsset.notAllowedInInventory &amp;&amp; !string.IsNullOrEmpty(inventoryAsset.assetId))
        {
            UserManager.instance.getUser().addItem(inventoryAsset);
        }

        SoundManager.instance.playCollectGemSound();
    }

    protected virtual void Update()
    {
        if (transform.position.y &lt; yDeathPosition)
        {
            die();
        }
    }

    public async void destroyAfterMaxLife()
    {
        await UniTask.WaitForSeconds(maxLife);
        die();
    }

    protected virtual void updateHp(long newVal)
    {
        hp = newVal;
    }

    protected bool usingDropBag;
    protected long hp = 1;
    protected long maxHp = 1;
    protected long goldValue = 1;
    protected long xpValue = 1;
    protected bool isDead;
    private Action&lt;ItemInstance&gt; destroyCb;
    public InventoryAsset inventoryAsset;
    private MeshCollider meshCollider;
    protected Transform graphic;
    private const int maxLife = 5;
    private const float yDeathPosition = -2;

}</code></pre>
        </div>
      </div>
    </section>

    <div class="text-end">
      <a class="btn btn-brand" href="#top">Back to top</a>
    </div>
  </main>

  <footer class="py-4 mt-4 text-center text-secondary">
    © 2025 Jayben Bushnell
  </footer>

  <button type="button" class="btn btn-brand" id="toTopBtn">↑ Top</button>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-c.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-cs.min.js"></script>
  <script>
    document.querySelectorAll('.copy').forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.getAttribute('data-target');
        const el = document.getElementById(id);
        navigator.clipboard.writeText(el.textContent);
        btn.textContent = 'Copied';
        setTimeout(() => btn.textContent = 'Copy', 1200);
      });
    });
    const topBtn = document.getElementById('toTopBtn');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) topBtn.style.display = 'block';
      else topBtn.style.display = 'none';
    });
    topBtn.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));
  </script>
</body>
</html>
